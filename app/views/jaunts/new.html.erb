<meta name="viewport" content="initial-scale=1.0">

<style>
html, body {
  height: 100%;
  margin: 0;
  padding: 0;
}
#map {
  height: 100%;
}
</style>


<div id="map"></div>

<script>
var map, latitude, longitude;

function initMap() {
  if(latitude && longitude) {
    map = new google.maps.Map(document.getElementById('map'), {
      center: {lat: latitude, lng: longitude},
      zoom: 12
    });
  } else {
    setTimeout(initMap, 100);
  }
}

navigator.geolocation.getCurrentPosition(function(geo) {
  latitude  = geo.coords.latitude;
  longitude = geo.coords.longitude;
});
</script>

<script src="https://maps.googleapis.com/maps/api/js?key=<%= @api_key || raise %>&callback=initMap" async defer>
</script>
